
---
title: "ST558- Final Project, Modeling File"
author: "Alex Devoid"
date: "July 29, 2024"
format: html
---
  
  # Introduction
  
  This document details the modeling process for predicting the `Diabetes_binary` outcome using various machine learning techniques, including Logistic Regression, Classification Tree, and Random Forest. We utilize the `caret` package for model training and evaluation, employing log loss as our primary metric.

## Log Loss and Its Importance

Log loss, or logarithmic loss, measures the accuracy of a classification model by penalizing false classifications. Unlike accuracy, which simply counts correct classifications, log loss takes into account the confidence of the predictions, giving higher penalties for confident but wrong predictions. This makes log loss particularly suitable for situations where understanding the certainty of predictions is crucial, such as medical diagnosis.

## Data Preparation

The dataset has been split into training and testing sets, with 70% allocated to training and 30% to testing. We have also scaled the numerical features and encoded categorical variables as factors.

```{r}
# Load necessary libraries
library(caret)
library(dplyr)

# Load the data
data <- read.csv("data/diabetes_binary_health_indicators_BRFSS2015.csv")

# Convert categorical variables to factors
data <- data %>%
  mutate(across(where(is.numeric), as.factor))

# Split the data
set.seed(42)
trainIndex <- createDataPartition(data$Diabetes_binary, p = .7, list = FALSE)
training_data <- data[trainIndex,]
testing_data <- data[-trainIndex,]

# Standardize numerical features
preProcess_scale <- preProcess(training_data[, -1], method = c("center", "scale"))
training_data_scaled <- predict(preProcess_scale, training_data[, -1])
testing_data_scaled <- predict(preProcess_scale, testing_data[, -1])
```

# Logistic Regression

Logistic regression is a statistical model used for binary classification tasks. It predicts the probability of an outcome that can only take two possible values (like having diabetes or not). Logistic regression is appropriate here because our response variable, `Diabetes_binary`, is binary.

## Model Training

We use the `caret` package to fit three candidate logistic regression models with different sets of predictors. The best model is selected based on log loss.

```{r}
# Training control setup for cross-validation
train_control <- trainControl(method = "cv", number = 5, classProbs = TRUE, summaryFunction = mnLogLoss)

# Logistic regression model training
logistic_model <- train(Diabetes_binary ~ ., data = training_data_scaled, method = "glm", family = "binomial", trControl = train_control)

# Display the best logistic model
logistic_model
```
